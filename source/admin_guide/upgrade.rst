新しいバージョンへのアップグレード
==========================

.. 警告:: `ChangeLog <https://github.com/kanboard/kanboard/blob/master/ChangeLog>`_ を見ること無しで盲目的なアップデートをしないでください。
             重大な変更点の確認を怠らないでください。

殆どの場合、Kanboardを新しいバージョンへのアップグレードはシームレスです。この手順を要約すると、単純にdataフォルダを新しいKanboardフォルダにコピーするだけです。Kanboard は自動的にデータベースのマイグレーションを実行します

アップグレードを実行する前の重要な事
--------------------------------------

-  **アップグレードする前に毎回データフォルダのバックアップを取る**
-  **バックアップが有効か確認する**
-  毎回 `ChangeLog <https://github.com/kanboard/kanboard/blob/master/ChangeLog>`__
   を読み、大きな変更点を確認する
-  workerを使用している場合、停止する
-  ソフトウェアのアップグレード中にユーザーに使用されるのを避けるため、webサーバーをメンテナンスモードに置く

アーカイブよりインストール (安定版)
---------------------------------

1. 新しいアーカイブを展開する
2. ``data`` フォルダを新しく展開したディレクトリにコピーする
3. もし ``config.php`` をカスタムしてるなら、それもコピーするプラグインをインストールしている場合、最新版にアップデートする
5. ``data`` ディレクトリをwebサーバのユーザーが書き込みできるようにする
6. 必要ならば ``.htaccess`` ファイルも修正する (例:SSL接続の強制)
7. 動作試験
8. 古いKanboardのディレクトリの削除

リポジトリからインストール (開発版)
-----------------------------------------

1. ``git pull``
2. ログインして、全て問題が無いか確認する。

-  この方法は **現在開発中のバージョン** , をインストールするため、自己責任で使用してください。
-  `ChangeLog <https://github.com/kanboard/kanboard/blob/master/ChangeLog>`_ を見ること無しで盲目的なアップデートをしないでください。

手動でのSQLマイグレーション
-------------------------------

デフォルトでは、SQLマイグレーションは自動的に実行されます。スキーマのバージョンはリクエストの都度確認されます。この方法では、Kanboardを別のバージョンにアップグレードする時、データベースのスキーマはあなたのためにアップデートされます。
この方法は **完全ではありません** 。

-  **マイグレーションを実行するとき、データベースにアクセスするプロセスが1つだけになることを確認してください** 
-  データベーススキーマの変更中にソフトウェアをユーザーに使用されるのを避けるため、Kanboardインスタンスを"メンテナンスモード"に置く

データベースのマイグレーションを手動で行うには、設定ファイル中の ``DB_RUN_MIGRATIONS`` パラメータを ``false`` にしてください。

Kanboardのアップグレードに必要な事が出来たら、以下のコマンドを実行してください:

.. code:: bash

    ./cli db:migrate
